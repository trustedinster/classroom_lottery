# 课堂抽号程序

这是一个专为课堂教学设计的随机抽号程序，支持多种抽取模式和语音叫号功能，适用于Windows 7及以上操作系统。

## 功能特性

### 1. 多种抽取模式
- **全随机模式**：完全随机抽取学生号码
- **学生讲题模式（正序）**：按顺序从前往后抽取，确保每个学生都有机会
- **学生讲题模式（倒序）**：按顺序从后往前抽取，提供更多样化的抽取方式

### 2. 语音叫号功能
- 支持中文语音播报抽取结果
- 可自定义叫号文本模板
- 兼容Windows 7及以上系统
- 可开关语音功能

### 3. 灵活配置
- 可设置号码范围（最小值、最大值）
- 可调节动画延迟时间和结果显示时间
- 支持通过图形界面或配置文件进行设置

### 4. 用户友好界面
- 托盘图标常驻，方便随时调用
- 全局快捷键触发抽号（Alt键）
- 简洁明了的结果显示窗口
- 支持Esc键快速关闭结果窗口

## 安装与使用

### 启动器程序 (launcher.py)
启动器提供图形界面用于配置各项参数：
- 编辑号码范围（最小值、最大值）
- 设置动画延迟和结果显示时间
- 选择抽取模式
- 配置语音叫号功能
- 选择并启动不同版本的主程序

### 主程序 (main.py)
主程序负责实际的抽号功能：
- 通过快捷键（Alt）触发抽号
- 显示抽号结果
- 播放语音叫号（如果启用）

## 配置说明

配置存储在 `config.ini` 文件中：

```ini
[lottery]
min_number = 1           # 最小号码
max_number = 48          # 最大号码
delay = 0                # 动画延迟（秒）
keep = 1                 # 结果保持时间（秒）
student_mode = 1         # 抽取模式（0=全随机，1=正序，2=倒序）
enable_voice = 1         # 是否启用语音叫号（0=关闭，1=开启）
voice_template = 请{}号同学回答问题  # 语音叫号模板
```

## 语音叫号定制

可以通过修改 `voice_template` 来定制叫号内容：
- 使用 `{}` 作为号码占位符
- 示例：
  - `请{}号同学起立`
  - `{}号同学请回答`
  - `现在轮到第{}号同学`

## 系统要求

- Windows 7 或更高版本
- Python 3.6+
- 依赖库详见 requirements.txt

## 技术特点

- 使用 Tkinter 构建图形界面
- 利用 Windows SAPI 实现 TTS 语音功能
- 支持多版本程序管理
- 日志记录便于问题排查
- 兼容打包为 exe 文件运行

## 使用方法

1. 运行 `launcher.py` 启动配置界面
2. 设置所需参数并保存
3. 启动主程序
4. 在需要抽号时按下 Alt 键即可